### üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö CasaOS

#### ‚úÖ –®–∞–≥ 1: –ü—Ä–æ–±—Ä–æ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ iGPU

- –ù–∞–π–¥–∏ –±–ª–æ–∫ **"–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"** (–≤–Ω–∏–∑—É –Ω–∞ –≤—Ç–æ—Ä–æ–º —Å–∫—Ä–∏–Ω–µ).
- –ù–∞–∂–º–∏ `+ –î–æ–±–∞–≤–∏—Ç—å`.
- –í –ø–æ–ª–µ —É–∫–∞–∂–∏:
  ```
  /dev/dri/renderD128
  ```
- –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—ã –¥–æ–ª–∂–µ–Ω —É–≤–∏–¥–µ—Ç—å —Å—Ç—Ä–æ–∫—É —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º `/dev/dri/renderD128`.

> üí° **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ**: –µ—Å–ª–∏ –±—É–¥–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è ‚Äî –¥–æ–±–∞–≤—å –∏ `/dev/dri/card0`

---

#### ‚úÖ –®–∞–≥ 2: –°–¥–µ–ª–∞–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º

- –í —Ç–æ–º –∂–µ –±–ª–æ–∫–µ –Ω–∏–∂–µ –µ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å **"–ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π"** ‚Äî –≤–∫–ª—é—á–∏ –µ–≥–æ (–ø–µ—Ä–µ–≤–µ–¥–∏ –≤ –∞–∫—Ç–∏–≤–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ).
- –≠—Ç–æ –¥–∞—Å—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç —á–∞—Å—Ç—å –ø—Ä–æ–±–ª–µ–º —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ GPU.

---

#### ‚úÖ –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è)

**–ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π `vainfo` –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç –ø–∞–¥–∞—Ç—å —Å `va_openDriver() = -1`**, –¥–æ–±–∞–≤—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- –ù–∞–∂–º–∏ `+ –î–æ–±–∞–≤–∏—Ç—å` –≤ —Ä–∞–∑–¥–µ–ª–µ **"–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"**
- –ö–ª—é—á:
  ```
  LIBVA_DRIVER_NAME
  ```
- –ó–Ω–∞—á–µ–Ω–∏–µ:
  ```
  radeonsi
  ```

---

#### ‚úÖ –®–∞–≥ 4: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

- –ù–∞–∂–º–∏ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å** –≤–Ω–∏–∑—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
- CasaOS –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–º–æ–∂–µ—Ç —Å–ø—Ä–æ—Å–∏—Ç—å, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–ª–∏ –Ω–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ç–æ–º–∞ ‚Äî —Å–æ–≥–ª–∞—Å–∏—Å—å).
- –ü—Ä–æ–≤–µ—Ä—å —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Jellyfin ‚Üí `Playback` ‚Üí `Hardware Acceleration`, —á—Ç–æ VAAPI –¥–æ—Å—Ç—É–ø–Ω–∞ –∏ –≤–∫–ª—é—á–µ–Ω–∞.

---

### üìã –ü—Ä–æ–≤–µ—Ä—å –≤ —Å–∞–º–æ–º Jellyfin

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:

1. –ü–µ—Ä–µ–π–¥–∏ –≤ Web UI Jellyfin: `http://casaos.local:8096`
2. –í–æ–π–¥–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –û—Ç–∫—Ä–æ–π: **Playback ‚Üí Hardware Acceleration**
4. –í–∫–ª—é—á–∏:
   - [x] **Hardware acceleration**
   - [x] VAAPI
   - –£–∫–∞–∂–∏ –ø—É—Ç—å –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É:
     ```
     /dev/dri/renderD128
     ```
5. –°–æ—Ö—Ä–∞–Ω–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Jellyfin (–º–æ–∂–Ω–æ –ø—Ä—è–º–æ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ).

---

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–ü–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –ª—é–±–æ–≥–æ –≤–∏–¥–µ–æ:
- –ó–∞–π–¥–∏ –≤ **Dashboard ‚Üí Activity ‚Üí Playback**, –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ **—Ç—Ä–∞–Ω—Å–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ**.
- –¢–∞–∫–∂–µ –≤ `Logs` –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∑–∞–ø–∏—Å–∏ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ VAAPI (–Ω–∞–ø—Ä–∏–º–µ—Ä: `VAAPI: Using device /dev/dri/renderD128`).

---

–¢—ã –≤—Å—ë —Å–¥–µ–ª–∞–ª –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ ‚Äî –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö –≤–∏–¥–Ω–æ, —á—Ç–æ Jellyfin —Ä–∞—Å–ø–æ–∑–Ω–∞–ª —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ `/dev/dri/renderD128` –∏ –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ VAAPI. –ù–∏–∂–µ ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç, —á—Ç–æ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∞ —Ç–∞–∫–∂–µ –∫–∞–∫ **—É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ transcoding –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ iGPU**.

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –¥–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Jellyfin

### 1. üîß –ß—Ç–æ —Ç—ã —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏–ª:

- **–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ:** VAAPI –≤—ã–±—Ä–∞–Ω–æ.
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ VAAPI:** —É–∫–∞–∑–∞–Ω–æ `/dev/dri/renderD128` ‚Äî ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
- **–î–µ–∫–æ–¥–µ—Ä—ã –≤–∫–ª—é—á–µ–Ω—ã:** H.264, HEVC 10bit –∏ VC1 ‚Äî ‚úÖ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø—Ä–æ—Ñ–∏–ª–∏ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –≤–∏–¥–µ–æ.
- **–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ:** –æ–ø—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞ ‚Äî ‚úÖ
- **–ü—É—Ç—å –∫ ffmpeg —É–∫–∞–∑–∞–Ω:** `/usr/lib/jellyfin-ffmpeg/ffmpeg` ‚Äî ‚úÖ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø—É—Ç—å –¥–ª—è Jellyfin –Ω–∞ –±–∞–∑–µ `linuxserver/jellyfin`

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ Jellyfin –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç iGPU

### –°–ø–æ—Å–æ–± 1: –õ–æ–≥–∏ Jellyfin

1. –ü–µ—Ä–µ–π–¥–∏ –≤ **–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Üí –°–æ–±—ã—Ç–∏—è –∏–ª–∏ –ñ—É—Ä–Ω–∞–ª —Å–µ—Ä–≤–µ—Ä–∞**.
2. –ó–∞–ø—É—Å—Ç–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, —Ç—Ä–µ–±—É—é—â–µ–≥–æ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, H.264 –≤ HEVC).
3. –í –ª–æ–≥–∞—Ö –∏—â–∏ —Å—Ç—Ä–æ—á–∫–∏ —Ç–∏–ø–∞:
   ```
   [FFmpeg] Using VAAPI device /dev/dri/renderD128
   [VAAPI] Hardware decode/encode started
   ```
   –≠—Ç–æ ‚Äî –∂–µ–ª–µ–∑–æ–±–µ—Ç–æ–Ω–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ.

---

### –°–ø–æ—Å–æ–± 2: –ü—Ä—è–º–æ–π –∑–∞–º–µ—Ä —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª (–µ—Å–ª–∏ –≤—Å—ë-—Ç–∞–∫–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ —É —Ç–µ–±—è –æ—Ç–∫—Ä—ã—Ç root-–¥–æ—Å—Ç—É–ø –≤ CasaOS:

```bash
watch -n 1 cat /sys/kernel/debug/dri/0/amdgpu_pm_info
```

–¢–∞–º –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∑–∞–≥—Ä—É–∑–∫—É VCN (–≤–∏–¥–µ–æ-—è–¥—Ä–∞ AMD), —á—Ç–æ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ iGPU –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω.

---

### üõ† –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

- **–í–∫–ª—é—á–∏ –¥–µ–∫–æ–¥–µ—Ä—ã VP9, AV1, HEVC Main:** –µ—Å–ª–∏ –∑–Ω–∞–µ—à—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å —Ç–∞–∫–∏–µ —Ñ–∞–π–ª—ã ‚Äî –º–æ–∂–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≥–∞–ª–æ—á–∫–∏.
- **–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ HEVC/AV1:** –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —Ç—Ä–∞–Ω—Å–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –≤ HEVC ‚Äî –∞–∫—Ç–∏–≤–∏—Ä—É–π —ç—Ç–∏ —á–µ–∫–±–æ–∫—Å—ã.
- **VPP-—Ç–æ–Ω–∞–º–ø–∏–Ω–≥:** —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ Intel, —É —Ç–µ–±—è AMD Radeon 660M ‚Äî –º–æ–∂–Ω–æ **–Ω–µ –≤–∫–ª—é—á–∞—Ç—å**.

---

## üìå –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–æ–≤ VAAPI –Ω–∞ Radeon 660M

Radeon 660M (Rembrandt, RDNA2 + VCN 3.1) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

| –ö–æ–¥–µ–∫      | –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ | –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ |
|------------|----------------|-------------|
| H.264      | ‚úÖ              | ‚úÖ           |
| HEVC (H.265)| ‚úÖ              | ‚úÖ           |
| VP9        | ‚úÖ              | ‚ùå (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ) |
| AV1        | ‚úÖ              | ‚ùå           |

–¢–∞–∫ —á—Ç–æ **–Ω–µ –∂–¥–∏ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ AV1 –∏–ª–∏ VP9 —á–µ—Ä–µ–∑ VAAPI**, –Ω–æ **H.264/HEVC** —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ.

---

## ‚úÖ –í—ã–≤–æ–¥

–¢–≤–æ—è —Ç–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Jellyfin:

‚úîÔ∏è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ VAAPI  
‚úîÔ∏è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ  
‚úîÔ∏è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–µ –∫–æ–¥–µ–∫–∏  

–û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏ —É–±–µ–¥–∏—Ç—å—Å—è –ø–æ –ª–æ–≥–∞–º –∏–ª–∏ –º–µ—Ç—Ä–∏–∫–∞–º, —á—Ç–æ transcoding –∏–¥—ë—Ç —á–µ—Ä–µ–∑ iGPU.

---

## üö® –¢–µ–∫—É—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∞

- VAAPI –¥–æ—Å—Ç—É–ø–Ω–æ (`libva info: VA-API version 1.20.0`)
- –î—Ä–∞–π–≤–µ—Ä `radeonsi` –Ω–∞–π–¥–µ–Ω (`Trying to open .../radeonsi_drv_video.so`)
- –û—à–∏–±–∫–∞ `va_openDriver() returns -1` = –ø—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π.

---

## üß© –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. üì¶ –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –ø–∞–∫–µ—Ç `mesa-va-drivers`

–î—Ä–∞–π–≤–µ—Ä `radeonsi_drv_video.so` –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å, –Ω–æ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è.

üìå **–†–µ—à–µ–Ω–∏–µ ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë –¥–ª—è VAAPI –Ω–∞ AMD –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**

```bash
apt update
apt install -y mesa-va-drivers libva-drm2 libdrm-amdgpu1 libdrm2
```

–¢–∞–∫–∂–µ –Ω–µ –ø–æ–º–µ—à–∞–µ—Ç:

```bash
apt install -y vainfo
```

---

### 2. ‚ùó –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –¥—Ä–∞–π–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å GPU –±–µ–∑ `card0` (—É–∂–µ –ø—Ä–æ–±—Ä–æ—à–µ–Ω–æ ‚Äî —ç—Ç–æ –æ–∫)

–ù–æ **–∏–Ω–æ–≥–¥–∞** AMD-—à–Ω—ã–µ `libdrm_amdgpu` –∑–∞–≤—è–∑–∞–Ω—ã –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ DRM-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∞–≤ –≤ cgroup.

üìå **–ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∞ –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:**

```bash
ls -l /dev/dri/
```

–û–±–∞ —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:

```
crw-rw---- 1 root video 226, 0   card0
crw-rw---- 1 root video 226, 128 renderD128
```

–ï—Å–ª–∏ `renderD128` –≤—Å—ë –µ—â—ë –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç `abc` ‚Äî –∑–∞–¥–∞–π:

```bash
chgrp video /dev/dri/renderD128
```

---

### 3. üß™ –ó–∞–ø—É—Å–∫ `vainfo` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–æ–ø—Ä–æ–±—É–π –≤—ã–ø–æ–ª–Ω–∏—Ç—å `vainfo` —Å —è–≤–Ω–æ –∑–∞–¥–∞–Ω–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥—Ä–∞–π–≤–µ—Ä–∞ **–∏** —Å–æ–∑–¥–∞–¥–∏–º XDG runtime:

```bash
export LIBVA_DRIVER_NAME=radeonsi
export XDG_RUNTIME_DIR=/tmp/xdg
mkdir -p $XDG_RUNTIME_DIR
chmod 700 $XDG_RUNTIME_DIR
vainfo
```

---

### 4. ‚õî –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—Å—ë –µ—â—ë –Ω–µ "–≤–∏–¥–∏—Ç" –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π GPU —Å—Ç–µ–∫

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ–≥–æ –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ `vainfo` –≤—Å—ë –µ—â—ë –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `va_openDriver() = -1`, –≤–æ–∑–º–æ–∂–Ω–æ, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:

- –ª–∏–±–æ **–ø—Ä–∏–≤–∏–ª–µ–≥–∏–π** (`--privileged` –Ω–µ –≤–∫–ª—é—á–µ–Ω),
- –ª–∏–±–æ **udev-–ø—Ä–∞–≤–∏–ª/CGROUP –¥–æ—Å—Ç—É–ø–∞**.

üìå **–†–µ—à–µ–Ω–∏–µ**: –≤ CasaOS –≤–∫–ª—é—á–∏:

- –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å **"–ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä"**
- –ø—Ä–æ–±—Ä–æ—Å–∏ **–∏ `/dev/dri/card0`, –∏ `/dev/dri/renderD128`** –≤ —Ä–∞–∑–¥–µ–ª–µ **"–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"**

---

## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å (—à–∞–≥–∏)

1. –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤—ã–ø–æ–ª–Ω–∏:

```bash
chgrp video /dev/dri/renderD128
chmod 660 /dev/dri/renderD128
usermod -aG video jellyfin
apt update
apt install -y mesa-va-drivers libva-drm2 libdrm-amdgpu1 libdrm2 vainfo
export LIBVA_NO_DISPLAY=1
export LIBVA_DRIVER_NAME=radeonsi
export XDG_RUNTIME_DIR=/tmp/xdg
mkdir -p $XDG_RUNTIME_DIR && chmod 700 $XDG_RUNTIME_DIR
vainfo
```

2. –ü—Ä–æ–≤–µ—Ä—å –≤—ã–≤–æ–¥. –ï—Å–ª–∏ `vainfo` –Ω–∞—á–Ω—ë—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ (H264, HEVC...), –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ.

3. –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ `va_openDriver = -1` ‚Äî –ø—Ä–æ–≤–µ—Ä—å:

- –ü—Ä–æ–±—Ä–æ—à–µ–Ω—ã –ª–∏ –æ–±–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ CasaOS
- –í–∫–ª—é—á—ë–Ω –ª–∏ —Ñ–ª–∞–≥ "–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä"
- –ù–∞–∑–Ω–∞—á–µ–Ω–∞ –ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `PGID=44` (–≥—Ä—É–ø–ø–∞ `video`) ‚Äî —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Jellyfin –º–æ–≥ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø

---

–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –¥–æ–∂–∞—Ç—å –¥–æ –∫–æ–Ω—Ü–∞ ‚Äî –ø—Ä–∏—à–ª–∏ —Å–ª–µ–¥—É—é—â–∏–π –≤—ã–≤–æ–¥ `vainfo` –ø–æ—Å–ª–µ –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã—Ö —à–∞–≥–æ–≤.


