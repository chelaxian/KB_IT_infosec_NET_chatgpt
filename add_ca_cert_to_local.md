Чтобы добавить сертификат `ca.crt` в доверенные корневые сертификаты и `cert.pfx` в личное хранилище сертификатов на Linux (Debian 12), выполните следующие шаги:

### 1. Добавление `ca.crt` в доверенные корневые сертификаты

1. **Копируйте сертификат в системную директорию доверенных сертификатов**:

```bash
sudo cp ca.crt /usr/local/share/ca-certificates/
```

2. **Обновите хранилище доверенных сертификатов**:

```bash
sudo update-ca-certificates
```

### 2. Импорт `cert.pfx` в личное хранилище сертификатов

1. **Установите необходимые утилиты для работы с сертификатами**:

```bash
sudo apt update
sudo apt install libnss3-tools openssl -y
```

2. **Преобразуйте `cert.pfx` в формат PEM (для ключа и сертификата отдельно)**:

```bash
openssl pkcs12 -in cert.pfx -out cert.pem -nodes -clcerts -password pass:1
```

Это создаст файл `cert.pem` с закрытым ключом и сертификатом.

3. **Импортируйте сертификат в личное хранилище сертификатов**:

```bash
certutil -d sql:$HOME/.pki/nssdb -A -t "P,," -n "Мой сертификат" -i cert.pem
```

Здесь:
- `-d sql:$HOME/.pki/nssdb` — путь к вашему личному хранилищу сертификатов.
- `-A` — добавление сертификата.
- `-t "P,,"` — доверие сертификату только для SSL.
- `-n "Мой сертификат"` — имя сертификата в хранилище.
- `-i cert.pem` — путь к файлу сертификата.

Эти команды добавят ваш корневой сертификат в доверенные и ваш PFX сертификат в личное хранилище.

Ошибка `certutil: unable to open "cert.pem" for reading (-5966, 13)` указывает на проблемы с правами доступа к файлу `cert.pem` или с путём к файлу. Чтобы устранить эту ошибку, выполните следующие шаги:

### 1. Проверьте права доступа к файлу `cert.pem`

Убедитесь, что у вас есть достаточные права на чтение файла `cert.pem`. Попробуйте изменить права доступа:

```bash
sudo chmod 644 cert.pem
```

Это установит права на чтение для всех пользователей.

### 2. Убедитесь, что команда `certutil` используется с корректным путём

Если вы находитесь в директории, где лежит файл `cert.pem`, убедитесь, что используете правильный путь. Попробуйте указать путь к файлу явным образом:

```bash
certutil -d sql:$HOME/.pki/nssdb -A -t "P,," -n "Мой сертификат" -i ./cert.pem
```

### 3. Создайте хранилище, если оно не существует

Если директория `$HOME/.pki/nssdb` не существует, создайте её:

```bash
mkdir -p $HOME/.pki/nssdb
certutil -N -d sql:$HOME/.pki/nssdb
```

Это создаст новое хранилище сертификатов NSS.

### 4. Повторите команду

После выполнения всех шагов повторите команду:

```bash
certutil -d sql:$HOME/.pki/nssdb -A -t "P,," -n "Мой сертификат" -i ./cert.pem
```

Эти шаги должны помочь устранить ошибку и успешно импортировать сертификат.

Кажется, вы успешно создали базу данных NSS и теперь пытаетесь импортировать сертификат. Однако команда `certutil` запрашивает "Password or Pin for NSS Certificate DB". Это происходит, потому что база данных NSS защищена паролем, который вы установили ранее.

### Дальнейшие действия

1. **Введите пароль**: Введите пароль, который вы создали при выполнении команды `certutil -N -d sql:$HOME/.pki/nssdb`.

2. **Повторите импорт сертификата**: Если по каким-то причинам сертификат не импортируется, убедитесь, что вы вводите правильный пароль и что у вас есть права доступа к базе данных и файлу сертификата.

Если после ввода пароля сертификат будет успешно импортирован, то дальнейших действий не потребуется.

### Проверка успешного импорта

После успешного импорта вы можете проверить список установленных сертификатов с помощью следующей команды:

```bash
certutil -L -d sql:$HOME/.pki/nssdb
```

Эта команда должна вывести список сертификатов, в котором будет присутствовать ваш сертификат с именем "Мой сертификат".

Если возникнут дополнительные вопросы или проблемы, дайте знать!

Ваш сертификат успешно импортирован в личное хранилище NSS, что подтверждается выводом команды `certutil -L`. Теперь ваш сертификат с именем "Мой сертификат" доступен для использования.

### Дальнейшие шаги

1. **Проверка доверия сертификата**: Убедитесь, что сертификат доверен для нужных вам целей (SSL, S/MIME и т.д.). В вашем случае установлен флаг `P,,`, что означает, что сертификат доверен только для SSL (серверов). Если вам нужно доверие для других целей, вы можете изменить атрибуты доверия, используя следующую команду:

    ```bash
    certutil -M -d sql:$HOME/.pki/nssdb -n "Мой сертификат" -t "CT,C,C"
    ```

    Здесь:
    - `C` — доверие для SSL клиентов.
    - `T` — доверие для SSL серверов.
    - `C` — доверие для S/MIME.
    - `C` — доверие для подписи кода (JAR/XPI).

2. **Использование сертификата**: Теперь ваш сертификат готов для использования в приложениях, которые используют NSS для управления сертификатами (например, Firefox, Thunderbird и другие приложения, использующие библиотеку NSS).

Если у вас есть другие вопросы или нужна дополнительная помощь, дайте знать!

