# –ù–ê–°–¢–†–û–ô–ö–ò SW 3750

> üéØ **–¶–µ–ª—å**: –µ—Å–ª–∏ **–Ω–∞ —Å–≤–∏—Ç—á –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç—Ä–∞—Ñ–∏–∫ –æ—Ç —Ö–æ—Å—Ç–∞ –∏–∑ VLAN139** –∫ –∞–¥—Ä–µ—Å—É `10.22.139.254` (–∫–æ—Ç–æ—Ä—ã–π —Ç–æ–∂–µ –≤ `10.22.139.0/24`), —Ç–æ **–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ VLAN139**, –∞ **—Ñ–æ—Ä—Å–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ö–æ–¥ —á–µ—Ä–µ–∑ ASA** –ø–æ –∞–¥—Ä–µ—Å—É `10.1.33.6` (–≤ `VLAN33`), **–≤–æ–ø—Ä–µ–∫–∏ —Ç–æ–º—É, —á—Ç–æ —Å–µ—Ç—å `10.22.139.0/24` ‚Äî directly connected**.

---

## ‚úÖ –ö–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

–ù–∞ L3-—Å–≤–∏—Ç—á–µ **Cisco 3750** —Å `IOS 12.2(55)SE10` —Ç—ã —É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω–∏–ª **Policy-Based Routing (PBR)** –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ `Vlan139`.

–≠—Ç–æ –∏ –µ—Å—Ç—å **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±** –æ–±–æ–π—Ç–∏ directly connected –º–∞—Ä—à—Ä—É—Ç ‚Äî —á–µ—Ä–µ–∑ **PBR –Ω–∞ ingress-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ**.

---

### üìå –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

#### 1. ACL –Ω–∞ —Ç—Ä–∞—Ñ–∏–∫ –∫ `10.22.139.254`

```shell
ip access-list extended ACL_TO_254
 permit ip any host 10.22.139.254
```

#### 2. Route-map —Å —É–∫–∞–∑–∞–Ω–∏–µ–º ASA –∫–∞–∫ next-hop

```shell
route-map PBR_TO_254 permit 10
 match ip address ACL_TO_254
 set ip next-hop 10.1.33.6
```

#### 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ PBR –Ω–∞ Vlan139 (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)

```shell
interface Vlan139
 ip policy route-map PBR_TO_254
```

---

### ‚ùó –í–ê–ñ–ù–û:

* –≠—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –Ω–∞ —Ç—Ä–∞—Ñ–∏–∫, –≤—Ö–æ–¥—è—â–∏–π –≤ Vlan139**, —Ç.–µ. **–æ—Ç —Ö–æ—Å—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –∫ –ø–æ—Ä—Ç–∞–º –≤ —ç—Ç–æ–º VLAN**.
* –ï—Å–ª–∏ —Ö–æ—Å—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ `10.22.139.254`, **switch –Ω–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å directly connected –º–∞—Ä—à—Ä—É—Ç**, –∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç —á–µ—Ä–µ–∑ `10.1.33.6`.

---

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞:

–ü–æ—Å–ª–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –æ—Ç —Ö–æ—Å—Ç–∞ –≤ Vlan139 –∫ 10.22.139.254:

```shell
show route-map PBR_TO_254
show access-lists ACL_TO_254
```

‚Üí –î–æ–ª–∂–Ω—ã —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è —Å—á—ë—Ç—á–∏–∫–∏ `Policy routing matches`.

---

### üö´ –ß—Ç–æ **–Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å**:

* **–ù–µ —Ç—Ä–æ–≥–∞–π** static route –Ω–∞ `10.22.139.254`, –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω.
* **–ù–µ –ø–æ–º–µ—á–∞–π** Vlan139 –∫–∞–∫ `ip nat inside` –∏–ª–∏ `outside` ‚Äî NAT –Ω–∞ 3750 **–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**, —Ç—ã —É–∂–µ —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏–ª.

---

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ FW ASA 5505

---

## üîÅ –¶–µ–ª—å:

> –ï—Å–ª–∏ —Ç—Ä–∞—Ñ–∏–∫ –∏–¥–µ—Ç:

* —Å **–≤–Ω–µ—à–Ω–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞** (`outside`),
* –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏–∑ `195.144.1.0/24`,
* –∫ **–Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é `10.22.139.143` –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ MGMT** ‚Äî
  ‚Üí —Ç–æ–≥–¥–∞ **source –¥–æ–ª–∂–µ–Ω –ø–æ–¥–º–µ–Ω—è—Ç—å—Å—è –Ω–∞ 10.22.139.254**

---

## üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ CLI (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç —Ç–≤–æ–µ–≥–æ GUI)

### 1. –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç—ã

```bash
object network EXT_NET_195
 subnet 195.144.1.0 255.255.255.0

object network CUS37_LAB_139_143
 host 10.22.139.143

object network SWCORE_SNAT_254
 host 10.22.139.254
```

---

### 2. –°–æ–∑–¥–∞—ë–º NAT-–ø—Ä–∞–≤–∏–ª–æ

```bash
nat (outside,MGMT) source static EXT_NET_195 SWCORE_SNAT_254 destination static CUS37_LAB_139_143 CUS37_LAB_139_143
```

---

### üîç –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ:

* –∑–∞–º–µ–Ω—è–µ—Ç `source IP` –Ω–∞ `10.22.139.254`
* —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:

  * **–∏—Å—Ç–æ—á–Ω–∏–∫** –∏–∑ `195.144.1.0/24` (EXT\_NET\_195),
  * **–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ** ‚Äî `10.22.139.143`,
  * –º–∞—Ä—à—Ä—É—Ç —Ç—Ä–∞—Ñ–∏–∫–∞: **–∏–∑ `outside` –≤ `MGMT`**

---

## üß© –£—Ç–æ—á–Ω–µ–Ω–∏–µ:

–ï—Å–ª–∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã **–ª—é–±–æ–π IP** (–Ω–µ —Ç–æ–ª—å–∫–æ `195.144.1.0/24`) –ø—Ä–æ—Ö–æ–¥–∏–ª NAT –¥–æ `10.22.139.254`, —Ç–æ –∑–∞–º–µ–Ω–∏ `EXT_NET_195` –Ω–∞ –æ–±—ä–µ–∫—Ç `any`:

```bash
object network OBJ_ANY
 subnet 0.0.0.0 0.0.0.0

nat (outside,MGMT) source static OBJ_ANY SWCORE_SNAT_254 destination static CUS37_LAB_139_143 CUS37_LAB_139_143
```

---

## üí° –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
show run nat
show xlate | include 10.22.139.254
```



