`wget` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTTPS, –∏—Å–ø–æ–ª—å–∑—É–π `curl`:

### **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `curl`**
```sh
curl -L -o /opt/bin/ttyd https://github.com/tsl0922/ttyd/releases/download/1.7.7/ttyd.mipsel
```
–§–ª–∞–≥ `-L` –Ω—É–∂–µ–Ω, —á—Ç–æ–±—ã `curl` —Å–ª–µ–¥–æ–≤–∞–ª —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞–º.

### **–î–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**
```sh
chmod +x /opt/bin/ttyd
```

### **–ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø—É—Å–∫**
```sh
/opt/bin/ttyd -p 81 sh
```

–ï—Å–ª–∏ **–Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å–∫–∞—á–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é**, —Å–∫–∞—á–∞–π —Ñ–∞–π–ª –Ω–∞ –ü–ö –∏ –ø–µ—Ä–µ–¥–∞–π –Ω–∞ —Ä–æ—É—Ç–µ—Ä —á–µ—Ä–µ–∑ `scp`:
```sh
scp ttyd.mipsel root@<IP_–†–û–£–¢–ï–†–ê>:/opt/bin/ttyd
```

### üéâ **–ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ `ttyd`**
`ttyd` **—É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è** –∏ **—Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 81**, –Ω–æ –≤ –ª–æ–≥–∞—Ö –µ—Å—Ç—å **–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (`W: _lws_smd_msg_send: rejecting message on queue depth 40`)**.

#### üìå **–ß—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è?**
–≠—Ç–∏ –æ—à–∏–±–∫–∏ —Å–≤—è–∑–∞–Ω—ã —Å `libwebsockets` (LWS) –∏ `lws_smd`, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏. –û–Ω–∏ **–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã**, –Ω–æ –æ–∑–Ω–∞—á–∞—é—Ç, —á—Ç–æ –æ—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π –¥–æ—Å—Ç–∏–≥–ª–∞ –ø—Ä–µ–¥–µ–ª–∞ (40 —Å–æ–æ–±—â–µ–Ω–∏–π).  

---

## ‚úÖ **1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å `ttyd` –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
–ü–æ–ø—Ä–æ–±—É–π **–æ—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ** (–∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏):
```
http://<IP_–†–û–£–¢–ï–†–ê>:81/
```
–ï—Å–ª–∏ **—Ä–∞–±–æ—Ç–∞–µ—Ç** ‚Üí –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.

–ï—Å–ª–∏ **–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è**, –ø—Ä–æ–≤–µ—Ä—å —á–µ—Ä–µ–∑ `netstat`:
```sh
netstat -tulnp | grep 81
```
–ò–ª–∏ —á–µ—Ä–µ–∑ `ss` (–µ—Å–ª–∏ `netstat` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):
```sh
ss -tulnp | grep 81
```
–ï—Å–ª–∏ `ttyd` –Ω–µ —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç, –ø–æ–ø—Ä–æ–±—É–π –¥—Ä—É–≥–æ–π:
```sh
ttyd -p 8080 sh
```
–ü–æ—Ç–æ–º —Å–Ω–æ–≤–∞ –∑–∞–π–¥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä:  
```
http://<IP_–†–û–£–¢–ï–†–ê>:8080/
```

---

## ‚úÖ **2. –î–æ–±–∞–≤–ª—è–µ–º `--writable`, –µ—Å–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è**
–í –ª–æ–≥–∞—Ö –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞:
```
[2025/02/07 10:48:47:1233] N: The --writable option is not set, will start in readonly mode
```
–ï—Å–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª **–Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã**, –ø–æ–ø—Ä–æ–±—É–π –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–∞–∫:
```sh
ttyd --writable -p 81 sh
```

---

## ‚úÖ **3. –î–æ–±–∞–≤–ª—è–µ–º `ttyd` –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫**
–°–æ–∑–¥–∞–π —Å–∫—Ä–∏–ø—Ç `/opt/etc/init.d/S99ttyd`:
```sh
nano /opt/etc/init.d/S99ttyd
```
–í—Å—Ç–∞–≤—å:
```sh
#!/bin/sh

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏
PORT=81
LOG_FILE="/opt/var/log/ttyd.log"
PID_FILE="/var/run/ttyd.pid"

start() {
    echo "–ó–∞–ø—É—Å–∫ ttyd..." | tee -a $LOG_FILE
    /opt/bin/ttyd --writable -p $PORT sh >> $LOG_FILE 2>&1 &  
    echo $! > $PID_FILE  
}

stop() {
    echo "–û—Å—Ç–∞–Ω–æ–≤–∫–∞ ttyd..." | tee -a $LOG_FILE
    if [ -f "$PID_FILE" ]; then
        kill $(cat $PID_FILE) 2>/dev/null
        rm -f $PID_FILE
    fi
}

restart() {
    stop
    sleep 2
    start
}

case "$1" in
    start) start ;;
    stop) stop ;;
    restart) restart ;;
    *) echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 {start|stop|restart}"; exit 1 ;;
esac

exit 0
```

–î–∞–µ–º –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
```sh
chmod +x /opt/etc/init.d/S99ttyd
```

–î–æ–±–∞–≤–ª—è–µ–º –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫:
```sh
ln -s /opt/etc/init.d/S99ttyd /opt/etc/init.d/rc.local
```

–ó–∞–ø—É—Å–∫–∞–µ–º –≤—Ä—É—á–Ω—É—é:
```sh
/opt/etc/init.d/S99ttyd start
```

---

## ‚úÖ **4. –û—á–∏—â–∞–µ–º –ª–æ–≥–∏ –æ—Ç `lws_smd_msg_send`**
–ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö **—Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π `rejecting message on queue depth 40`**, –º–æ–∂–Ω–æ **–æ—Ç–∫–ª—é—á–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è LWS**:
```sh
ttyd --writable --skip-syslog -p 81 sh
```
–ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–æ–±–∞–≤—å —ç—Ç–æ—Ç —Ñ–ª–∞–≥ –≤ **–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫**.

---

## **–í—ã–≤–æ–¥**
1. **–ü—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å `ttyd` —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä (`http://<IP_–†–û–£–¢–ï–†–ê>:81/`)**.
2. **–ï—Å–ª–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è** ‚Üí –¥–æ–±–∞–≤—å `--writable`.
3. **–ï—Å–ª–∏ –ª–æ–≥–æ–≤ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ** ‚Üí –¥–æ–±–∞–≤—å `--skip-syslog`.
4. **–î–æ–±–∞–≤—å `ttyd` –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫** –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞.

üöÄ **–¢–≤–æ–π `ttyd` —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!** –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –¥–æ–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å. –ù–∞–ø–∏—à–∏, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫. üî•
